from urllib.parse import urlparse, parse_qs, urlunparse

def clean_taobao_url(url):
    # 解析 URL
    parsed = urlparse(url)
    # 提取查询参数
    query_params = parse_qs(parsed.query)
    
    # 仅保留 id 和 skuId（注意大小写）
    allowed_params = {'id', 'skuid'}
    clean_params = {}
    for key in query_params:
        if key.lower() in allowed_params:
            clean_params[key] = query_params[key][0]  # 取第一个值
    
    # 重建 URL
    new_query = '&'.join([f"{k}={v}" for k, v in clean_params.items()])
    new_parsed = parsed._replace(query=new_query)
    return urlunparse(new_parsed)

# 示例输入
urls = [
  'https://detail.tmall.com/item.htm?abbucket=6&id=607086400827&pisk=gWKIDkXXQWVIFUhkSBDNC8JJJFSWAAo2286JnLEUeMId20O6iJzeUUu5yp5a4wuHaYT6wCbF96khVadJ9adPapyHSIJYYHuh4ushqghqgmo4Kpjl2N_aIsFh6tBx4yQRyMjTEEV7Smo2KdwFpxJt0H8cy-6LyudRJNUOF1ULvydRWlBl6kB8vgCtC1XR2TQRe5QOnT6Lvyd8WdBAe7URwgpTBT6c2_dR2A9OsTGYgf6iR6pIpArZeInGbpC_2uKKqw1fxzr7VhWdR3pP1dJwf9_CMNVoUQ-p_LKexN0QJgvwlQTJMfzF9E6X1Z8IGkOXtTp5eBi0h1KBFh_H7WUdhM1CkHQjVxphyFt1YHhuodJ19Zsw7VcFzMOBosbKSfAWC6RJANFI__82QHQ6Mfr6ZaTJYGKK6msy-o5b-I47CZq5CsksCz4uTjaeQOo5eAQdIO-qCANQrwBGCsksCz4lJOXN7AM_Ozf..&rn=684bf4dd2c5f38e378eb5b421142e1d6&spm=a1z10.3-b.w4011-21740987048.63.4a2e7ccbefPxbh&skuId=4264721757336',
'https://detail.tmall.com/item.htm?abbucket=6&id=607086400827&pisk=gWKIDkXXQWVIFUhkSBDNC8JJJFSWAAo2286JnLEUeMId20O6iJzeUUu5yp5a4wuHaYT6wCbF96khVadJ9adPapyHSIJYYHuh4ushqghqgmo4Kpjl2N_aIsFh6tBx4yQRyMjTEEV7Smo2KdwFpxJt0H8cy-6LyudRJNUOF1ULvydRWlBl6kB8vgCtC1XR2TQRe5QOnT6Lvyd8WdBAe7URwgpTBT6c2_dR2A9OsTGYgf6iR6pIpArZeInGbpC_2uKKqw1fxzr7VhWdR3pP1dJwf9_CMNVoUQ-p_LKexN0QJgvwlQTJMfzF9E6X1Z8IGkOXtTp5eBi0h1KBFh_H7WUdhM1CkHQjVxphyFt1YHhuodJ19Zsw7VcFzMOBosbKSfAWC6RJANFI__82QHQ6Mfr6ZaTJYGKK6msy-o5b-I47CZq5CsksCz4uTjaeQOo5eAQdIO-qCANQrwBGCsksCz4lJOXN7AM_Ozf..&rn=684bf4dd2c5f38e378eb5b421142e1d6&skuId=4816041187507&spm=a1z10.3-b.w4011-21740987048.63.4a2e7ccbefPxbh',
'https://detail.tmall.com/item.htm?abbucket=6&id=596083619692&pisk=gCV-DRDTnijlMrsO47WDtJaekT7cot4ykuz6tDmkdoEY-uH3qL0up9E8-UDIxzcdJoo0Z04oNDOLxyVuxyNnRWhzi8AnqglLRlcdjGfGszzraXsGjrU0sVGsWLiBx4MXhX0Kj3RKuzzrTDTDAO2bzHdY8kxIRD_xG23iRXgSVs_xJVnIO0MBcrgIcXiQAvMXhVgHO4MSVs_xS4pIABiWhjgoSUgQAX_YlmuIO4GViUnHPDdLC2PJfzCGgCRaM4H-vBmv9rFXsYosJmOCf5uJbcaSDBOIqFry5rUl2CzmaWZtSufXwlUQ7JMY9nstYSUbNJa22ZGTk-2ie-IW9mVoJAGIHeOQkXeSpSc11n34hz2QauLpO4PusvnZHwOEKjNiCRZJ8NzjN2ZEQWjwa0aQ75yi6_KZy-atMglas5F-3hmt-L_AkpJEFqRVl8c3CvOafqnGoKveLx0qkcbAkpJEFquxjZfMLpkmu&rn=684bf4dd2c5f38e378eb5b421142e1d6&spm=a1z10.3-b.w4011-21740987048.67.4a2e7ccbefPxbh&skuId=4308041655392',
'https://detail.tmall.com/item.htm?abbucket=6&id=680039978611&pisk=gAWKDPAAsP4hTBzY89PiE_srXWrGp5jEXwSjEUYnNNQOqwdl-Xxhw7QdqDAWrMv82N8GKejHdUMRrgXhrg6kVTpFI6Dk-yJRVZv8or20nMSeLLa0oGIGnn9X0bGSrH9s5LxJo2kJbMSeUUiiPSf1Y4HOc8uWVUZ9C3KDVLtBRRZ92nLWFeOS5GtW5LT5PQOs1ntoFHOBRRZ9DHTWPeGQCVtemHtCPBZOfF-WFHG4NDLoAUHRG3WKlME7AjccBHdpyYYsehBsnBYXAFM7lt-KuEsBWYMW-m7EcGI3JxSMLT_vmw2spZI50_OOeVavzOI1d_sZJl9AX1fD91UIeFXH2I9W60M5XLCBwOvbhVKN1Mf5Lwn-FHWhnQL26uMyZd6DGs_K4oS6d3_ygT4qLes50t5DHJ32v1svBg7NntBp_qYvqXZTXblyOhkaf6vlGQMVlhL0jfcraCxwXEqTXblyOh-9ol2mabRMb&rn=684bf4dd2c5f38e378eb5b421142e1d6&skuId=4877343593074&spm=a1z10.3-b.w4011-21740987048.71.4a2e7ccbefPxbh',
'https://detail.tmall.com/item.htm?abbucket=6&id=680039978611&pisk=gAWKDPAAsP4hTBzY89PiE_srXWrGp5jEXwSjEUYnNNQOqwdl-Xxhw7QdqDAWrMv82N8GKejHdUMRrgXhrg6kVTpFI6Dk-yJRVZv8or20nMSeLLa0oGIGnn9X0bGSrH9s5LxJo2kJbMSeUUiiPSf1Y4HOc8uWVUZ9C3KDVLtBRRZ92nLWFeOS5GtW5LT5PQOs1ntoFHOBRRZ9DHTWPeGQCVtemHtCPBZOfF-WFHG4NDLoAUHRG3WKlME7AjccBHdpyYYsehBsnBYXAFM7lt-KuEsBWYMW-m7EcGI3JxSMLT_vmw2spZI50_OOeVavzOI1d_sZJl9AX1fD91UIeFXH2I9W60M5XLCBwOvbhVKN1Mf5Lwn-FHWhnQL26uMyZd6DGs_K4oS6d3_ygT4qLes50t5DHJ32v1svBg7NntBp_qYvqXZTXblyOhkaf6vlGQMVlhL0jfcraCxwXEqTXblyOh-9ol2mabRMb&rn=684bf4dd2c5f38e378eb5b421142e1d6&spm=a1z10.3-b.w4011-21740987048.71.4a2e7ccbefPxbh&skuId=4877343593073',
'https://detail.tmall.com/item.htm?abbucket=6&id=680039978611&pisk=gAWKDPAAsP4hTBzY89PiE_srXWrGp5jEXwSjEUYnNNQOqwdl-Xxhw7QdqDAWrMv82N8GKejHdUMRrgXhrg6kVTpFI6Dk-yJRVZv8or20nMSeLLa0oGIGnn9X0bGSrH9s5LxJo2kJbMSeUUiiPSf1Y4HOc8uWVUZ9C3KDVLtBRRZ92nLWFeOS5GtW5LT5PQOs1ntoFHOBRRZ9DHTWPeGQCVtemHtCPBZOfF-WFHG4NDLoAUHRG3WKlME7AjccBHdpyYYsehBsnBYXAFM7lt-KuEsBWYMW-m7EcGI3JxSMLT_vmw2spZI50_OOeVavzOI1d_sZJl9AX1fD91UIeFXH2I9W60M5XLCBwOvbhVKN1Mf5Lwn-FHWhnQL26uMyZd6DGs_K4oS6d3_ygT4qLes50t5DHJ32v1svBg7NntBp_qYvqXZTXblyOhkaf6vlGQMVlhL0jfcraCxwXEqTXblyOh-9ol2mabRMb&rn=684bf4dd2c5f38e378eb5b421142e1d6&skuId=4877343593072&spm=a1z10.3-b.w4011-21740987048.71.4a2e7ccbefPxbh',
'https://detail.tmall.com/item.htm?abbucket=6&id=595497360716&pisk=g-gqmStN3EL44MlEF24N4ha1N4aYPPJIIVw_sfcgG-20cmiNQjGUffi_fFmr9YRY5AGgQAk7eZiXDlwN_8kc5ogZ6NPisAdYCIKSMjUTSp9I7eGxMU6y2w0Vo8jowW5co3Z0oTZAYp9BRF-cZPJ2dxGL1d8uTW4gilVgqQPQ6s4gjScka5V1nR2mIQlue5NGjZqgZzV_6s4giibuZSNdoG4Gozjue54gsoDiZQPsNfwgdaPUmCzI47kMdEy8Kj2PSw5LMoXSNG_CRTN0mJqu4NVSzSr4Kj0bPbxzZ4gzAu16HzcKVxVz8EWLg0cUo5u9tGyabqUzUv8hW7nm34qZPCKxaVy4xqqPiIl0y5Dgb0pFRSzj4kuqDCBoivwqxrh1TKGzY0rLZufNmriIOVEnoEWLFkFZUki2LZkh4bWTZmKjWmWGboV8aJOyawlPwvdW0ANVXGEx27yBMIIOXoV8aJOyaGITDyFzdIdA.&rn=684bf4dd2c5f38e378eb5b421142e1d6&spm=a1z10.3-b.w4011-21740987048.211.4a2e7ccbefPxbh&skuId=5747878224994',
'https://detail.tmall.com/item.htm?abbucket=6&id=595662823132&pisk=g4dmYt6tnKWXwMKLD35jpUnY2PD-Gr110hFOX1IZUgS5kEL9MfPwqnLOW-LN7Cx941BZcsdMqF-nlNnX6L4MR3xGCqsObGx97K3-9XLXl11wjDhK9agE7_K0gNWZ787OS4QV9SaY911Zvc28_tGh1H6QDIQaUaS5SNyNQhPraNsP7-5wbgWP8NPV_1-Zrg7N85SNbGlP4wsz3r7V78WPlNFVuiWZrUS571SZiRkVcCRya0-Bhb_6WxRFotjeui8vkQJLvML2V5VGmwX0HESu_5RkeJ9K0ikQyG1AcUbDfXNfgOvwM_Rq4f5ed3AGL6Dtlt8MEh1vaVyVYKKAaIJ3758liGxHZtZmqMRXzB1PeXuHzQtvlQYT7f7Jvg8Xg1cERsfV0_bW60NVjLJwMt1_0cj6ZUR2IgJUUJ8-15_rWQy_Ct75rMd7KSujhfr9r40uLV6VPZsKr42_Ct75rM3orJkf3a_fv&rn=ceeaf799ef13add35d3969e538ae6820&skuId=4983064880416&spm=a1z10.3-b.w4011-21740987048.83.654f7ccbDL8Lu5'

    # 添加更多链接...
]

# 处理并打印结果
for url in urls:
    print(clean_taobao_url(url))